#summary Integrating the output of a morphological analyzer

= Introduction =

This article assumes that you know how to train standard MarMoT models.
If not read [marmotTraining Training new models] first.

There are two ways of integrating the output of an analyzer.

= Morphological Dictionary =

The first way is to create a morphological dictionary, which is a text file listing a word form and a number of morphological features in each line. Word forms may occur multiple times. A German example could look like this:

<pre>
zweitägige      zweitägige      ADJA    degree=pos|gender=neut|case=nom|number=sg
zweitägige      zweitägige      ADJA    degree=pos|gender=noGend|case=acc|number=pl
zweitägige      zweitägige      ADJA    degree=pos|gender=noGend|case=nom|number=pl
Zustrom         Zustrom         NN      gender=masc|case=acc|number=sg
Zustrom         Zustrom         NN      gender=masc|case=dat|number=sg
Zustrom         Zustrom         NN      gender=masc|case=nom|number=sg
</pre>

In the example the dictionary lists the form, lemma, PoS and the morphological features.

If the dictionary file is 'mdict.txt' you can train a model using the following command:

<pre>
$ java -Xmx5G -cp marmot.jar marmot.morph.cmd.Trainer\
   -train-file form-index=1,tag-index=2,train.txt\
   -model-file de.marmot
   -type-dict mdict.txt,2,3
</pre>

Where 2 and 3 are the columns that hold features you want to use.
The word form must be in column 0 and all other columns (the lemma in the example) are ignored.

= Token Features =

While the morphological dictionary allows for simple feature integrating it does not provide a way to include word forms not know at training time. If MarMoT is to be used in a pipeline the token-feature-index is a more powerful alternative.

In order to use it you have to add a column containing the features to the training and test files:

<pre>
0       El       d       pos=article|gen=m|num=s     feat1#feat2
1       género   n       pos=common|gen=m|num=s      feat4
2       Marmota  n       pos=proper|gen=c|num=c      feat4#feat5
3       incluye  v       pos=main|gen=c|num=s|per=3  feat5
4       catorce  d       postype=numeral|gen=c|num=p feat1
5       especies n       postype=common|gen=f|num=p  feat2#feat4
6       .        f       punct=period                _
</pre>

Where features are separated by the "#" symbol and columns consisting only of "`_`" get ignored. For training you just have to add an option specifying the column:

<pre>
$ java -Xmx5G -cp marmot.jar marmot.morph.cmd.Trainer\
   -train-file form-index=1,tag-index=2,morph-index=3,token-feature-index=4,train.txt\
   -tag-morph true\
   -model-file es.marmot
</pre>

In contrast to the dictionary approach you also have to integrate the features during tagging:

<pre>
El       feat1#feat2
género   feat4
Marmota  feat4#feat5
incluye  feat5
catorce  feat1
especies feat2#feat4
.        _
</pre>

We also have to add the feature index to the tagging command:

<pre>
java -cp marmot.jar marmot.morph.cmd.Annotator\
 --model-file de.marmot\
 --test-file form-index=0,token-feature-index=1,text.txt\
 --pred-file text.out.txt\
</pre>